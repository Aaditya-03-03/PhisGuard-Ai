{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sarita/Downloads/PhisGuard-Ai/frontend/lib/firebase.ts"],"sourcesContent":["/**\r\n * Firebase Configuration for Frontend\r\n * Uses Firebase Auth for email/password and Google Sign-In\r\n */\r\n\r\nimport { initializeApp, getApps, getApp } from 'firebase/app';\r\nimport { getAuth, GoogleAuthProvider } from 'firebase/auth';\r\n\r\nconst firebaseConfig = {\r\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\r\n    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\r\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\r\n    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\r\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\r\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\r\n};\r\n\r\n// Initialize Firebase (prevent multiple initializations)\r\nconst app = getApps().length > 0 ? getApp() : initializeApp(firebaseConfig);\r\n\r\n// Initialize Auth\r\nexport const auth = getAuth(app);\r\n\r\n// Google Auth Provider\r\nexport const googleProvider = new GoogleAuthProvider();\r\ngoogleProvider.setCustomParameters({\r\n    prompt: 'select_account'\r\n});\r\n\r\nexport default app;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAED;AAAA;AACA;AAAA;;;AAEA,MAAM,iBAAiB;IACnB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACT;AAEA,yDAAyD;AACzD,MAAM,MAAM,IAAA,2KAAO,IAAG,MAAM,GAAG,IAAI,IAAA,0KAAM,MAAK,IAAA,iLAAa,EAAC;AAGrD,MAAM,OAAO,IAAA,6KAAO,EAAC;AAGrB,MAAM,iBAAiB,IAAI,wLAAkB;AACpD,eAAe,mBAAmB,CAAC;IAC/B,QAAQ;AACZ;uCAEe"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sarita/Downloads/PhisGuard-Ai/frontend/contexts/auth-context.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { createContext, useContext, useEffect, useState, type ReactNode } from 'react';\r\nimport {\r\n    type User,\r\n    onAuthStateChanged,\r\n    signInWithEmailAndPassword,\r\n    createUserWithEmailAndPassword,\r\n    signInWithPopup,\r\n    signOut,\r\n    updateProfile,\r\n} from 'firebase/auth';\r\nimport { auth, googleProvider } from '@/lib/firebase';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface AuthContextType {\r\n    user: User | null;\r\n    loading: boolean;\r\n    error: string | null;\r\n    signIn: (email: string, password: string) => Promise<void>;\r\n    signUp: (email: string, password: string, displayName: string) => Promise<void>;\r\n    signInWithGoogle: () => Promise<void>;\r\n    logout: () => Promise<void>;\r\n    clearError: () => void;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | null>(null);\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onAuthStateChanged(auth, (user) => {\r\n            setUser(user);\r\n            setLoading(false);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, []);\r\n\r\n    const signIn = async (email: string, password: string) => {\r\n        try {\r\n            setError(null);\r\n            setLoading(true);\r\n            await signInWithEmailAndPassword(auth, email, password);\r\n            router.push('/dashboard');\r\n        } catch (err: any) {\r\n            setError(getErrorMessage(err.code));\r\n            throw err;\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const signUp = async (email: string, password: string, displayName: string) => {\r\n        try {\r\n            setError(null);\r\n            setLoading(true);\r\n            const result = await createUserWithEmailAndPassword(auth, email, password);\r\n            await updateProfile(result.user, { displayName });\r\n            router.push('/dashboard');\r\n        } catch (err: any) {\r\n            setError(getErrorMessage(err.code));\r\n            throw err;\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const signInWithGoogle = async () => {\r\n        try {\r\n            setError(null);\r\n            setLoading(true);\r\n            await signInWithPopup(auth, googleProvider);\r\n            router.push('/dashboard');\r\n        } catch (err: any) {\r\n            setError(getErrorMessage(err.code));\r\n            throw err;\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const logout = async () => {\r\n        try {\r\n            await signOut(auth);\r\n            router.push('/login');\r\n        } catch (err: any) {\r\n            setError(getErrorMessage(err.code));\r\n        }\r\n    };\r\n\r\n    const clearError = () => setError(null);\r\n\r\n    return (\r\n        <AuthContext.Provider value={{\r\n            user,\r\n            loading,\r\n            error,\r\n            signIn,\r\n            signUp,\r\n            signInWithGoogle,\r\n            logout,\r\n            clearError,\r\n        }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useAuth() {\r\n    const context = useContext(AuthContext);\r\n    if (!context) {\r\n        throw new Error('useAuth must be used within an AuthProvider');\r\n    }\r\n    return context;\r\n}\r\n\r\n// Helper function to get user-friendly error messages\r\nfunction getErrorMessage(code: string): string {\r\n    switch (code) {\r\n        case 'auth/email-already-in-use':\r\n            return 'This email is already registered. Please sign in instead.';\r\n        case 'auth/invalid-email':\r\n            return 'Please enter a valid email address.';\r\n        case 'auth/operation-not-allowed':\r\n            return 'This sign-in method is not enabled.';\r\n        case 'auth/weak-password':\r\n            return 'Password must be at least 6 characters.';\r\n        case 'auth/user-disabled':\r\n            return 'This account has been disabled.';\r\n        case 'auth/user-not-found':\r\n            return 'No account found with this email.';\r\n        case 'auth/wrong-password':\r\n            return 'Incorrect password. Please try again.';\r\n        case 'auth/invalid-credential':\r\n            return 'Invalid email or password.';\r\n        case 'auth/popup-closed-by-user':\r\n            return 'Sign-in popup was closed. Please try again.';\r\n        case 'auth/popup-blocked':\r\n            return 'Sign-in popup was blocked. Please enable popups.';\r\n        default:\r\n            return 'An error occurred. Please try again.';\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AASA;AACA;AAbA;;;;;;AA0BA,MAAM,4BAAc,IAAA,kOAAa,EAAyB;AAEnD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAC9D,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6NAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAgB;IAClD,MAAM,SAAS,IAAA,2JAAS;IAExB,IAAA,8NAAS,EAAC;QACN,MAAM,cAAc,IAAA,wLAAkB,EAAC,mIAAI,EAAE,CAAC;YAC1C,QAAQ;YACR,WAAW;QACf;QAEA,OAAO,IAAM;IACjB,GAAG,EAAE;IAEL,MAAM,SAAS,OAAO,OAAe;QACjC,IAAI;YACA,SAAS;YACT,WAAW;YACX,MAAM,IAAA,gMAA0B,EAAC,mIAAI,EAAE,OAAO;YAC9C,OAAO,IAAI,CAAC;QAChB,EAAE,OAAO,KAAU;YACf,SAAS,gBAAgB,IAAI,IAAI;YACjC,MAAM;QACV,SAAU;YACN,WAAW;QACf;IACJ;IAEA,MAAM,SAAS,OAAO,OAAe,UAAkB;QACnD,IAAI;YACA,SAAS;YACT,WAAW;YACX,MAAM,SAAS,MAAM,IAAA,oMAA8B,EAAC,mIAAI,EAAE,OAAO;YACjE,MAAM,IAAA,mLAAa,EAAC,OAAO,IAAI,EAAE;gBAAE;YAAY;YAC/C,OAAO,IAAI,CAAC;QAChB,EAAE,OAAO,KAAU;YACf,SAAS,gBAAgB,IAAI,IAAI;YACjC,MAAM;QACV,SAAU;YACN,WAAW;QACf;IACJ;IAEA,MAAM,mBAAmB;QACrB,IAAI;YACA,SAAS;YACT,WAAW;YACX,MAAM,IAAA,qLAAe,EAAC,mIAAI,EAAE,6IAAc;YAC1C,OAAO,IAAI,CAAC;QAChB,EAAE,OAAO,KAAU;YACf,SAAS,gBAAgB,IAAI,IAAI;YACjC,MAAM;QACV,SAAU;YACN,WAAW;QACf;IACJ;IAEA,MAAM,SAAS;QACX,IAAI;YACA,MAAM,IAAA,6KAAO,EAAC,mIAAI;YAClB,OAAO,IAAI,CAAC;QAChB,EAAE,OAAO,KAAU;YACf,SAAS,gBAAgB,IAAI,IAAI;QACrC;IACJ;IAEA,MAAM,aAAa,IAAM,SAAS;IAElC,qBACI,0PAAC,YAAY,QAAQ;QAAC,OAAO;YACzB;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACJ;kBACK;;;;;;AAGb;AAEO,SAAS;IACZ,MAAM,UAAU,IAAA,+NAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACV,MAAM,IAAI,MAAM;IACpB;IACA,OAAO;AACX;AAEA,sDAAsD;AACtD,SAAS,gBAAgB,IAAY;IACjC,OAAQ;QACJ,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX,KAAK;YACD,OAAO;QACX;YACI,OAAO;IACf;AACJ"}}]
}